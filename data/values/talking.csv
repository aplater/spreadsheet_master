スプレットシートマスター
目的
,スプレットシートで管理しているものを全部Gitで管理しようというもの
使い方
,GASだけをGit管理したいとき
,,clasp提供のログインを行う
,,,npx clasp login
,,新規のスプレットシートを作成する
,,,npm run new name hoge
,,,,".clasp.jsonに""rootDir"":""dist""と追記されたものが作成される"
,,すでにプロジェクトにあるGASをビルド&デプロイ
,,,npm run build
,,,npx clasp push
,スプレットシート全体をGit管理したいとき
,,Cloud ConsoleからGoogleアプリ作成する
,,,使用するAPIのスコープを設定する
,,,,npx clasp loginした時に生成される内容と
,,,,dist/appsscript.json
,,,,を参照
,,認証情報のJSONファイルをcreds.jsonにリネーム
,,,spread_masterのプロジェクトに移動させる
,,自分の設定したGoogleの認証を行う
,,,npx clasp login --creds creds.json
,,.clasp.jsonの編集
,,,もし既存のスプレットシート、GASがある場合、spreadsheetIdとscriptId変更する
,,,作成したGoogleアプリケーションのprojectIdを記載する
,,スプレットシートの内容をダウンロードする
,,,npm run dump
,,,,"スプレットシートのセルの値をCSV, YAML化する"
,,,,スプレットシートをxlxsでダウンロードする
,,Git管理されているCSVをスプレットシートに再反映する
,,,npm run recreate
,,書式を再反映したいときは
,,npm run dumpしたときのxlsxをインポートする必要がある
,,,画像やメモも復元可能
,,,手順
,,,,スプレットシート -> ファイル -> インポート -> アップロード -> スプレットシートを置換する
,,Gitのコミットハッシュでスプレットシートの差分をビジュアライズに比較する
,,,使うときは
,,,,LibreOfficeをインストール
,,,,brew cask install xquartz
,,,,brew install diff-pdf
,,,npm run compare commit_hash 123456789abcd
,,,シートの順番変えられた時とか差分いっぱい出るからしんどい
余談
,src/gas
,,GASでのみ使用するスクリプト
,src/tasks
,,ローカルでのみ使用するスクリプト
,テストについて
,,GASないでのみ使えるものは全部モックで検証
,最近読めないExcel関数
,,INDEX MATCH
